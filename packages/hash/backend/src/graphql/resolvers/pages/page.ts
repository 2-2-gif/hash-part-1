import { ApolloError } from "apollo-server-express";

import { QueryPageArgs, Resolver } from "../../autoGeneratedTypes";
import { entities } from "../../../mockData/entities";
import { DbPage } from "../../../types/dbTypes";

export const page: Resolver<Promise<DbPage>, {}, {}, QueryPageArgs> = async (
  _,
  { id }
) => {
  const dbPage = (await entities.find(
    (entity) => entity.type === "Page" && entity.id === id
  )) as DbPage | undefined;

  if (!dbPage) {
    throw new ApolloError(`Page id ${id} not found`, "NOT_FOUND");
  }

  return dbPage;
};
