import { Resolver, Visibility } from "../../autoGeneratedTypes";
import { DbOrg, DbUser } from "../../../types/dbTypes";
import { GraphQLContext } from "../../context";

export const namespaces: Resolver<
  Promise<(DbUser | DbOrg)[]>,
  {},
  GraphQLContext,
  {}
> = async (_, {}, { dataSources }) => {
  const entities = await dataSources.db.getNamespaceEntities();
  return entities.map((entity) => {
    return {
      ...entity,
      id: entity.entityId,
      namespaceId: entity.accountId,
      visibility: Visibility.Public, // TODO: get from entity metadata
    } as DbUser | DbOrg;
  });
};
