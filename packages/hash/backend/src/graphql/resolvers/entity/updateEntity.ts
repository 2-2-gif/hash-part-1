import { ApolloError } from "apollo-server-express";

import { DbUnknownEntity } from "../../../types/dbTypes";
import { MutationUpdateEntityArgs, Resolver } from "../../autoGeneratedTypes";
import { entities } from "../../../mockData/entities";

export const updateEntity: Resolver<
  Promise<DbUnknownEntity>,
  {},
  {},
  MutationUpdateEntityArgs
> = async (_, { id, properties }) => {
  const entity = entities.find((entity) => entity.id === id) as DbUnknownEntity;

  if (!entity) {
    throw new ApolloError(`Could not find entity with id ${id}`, "NOT_FOUND");
  }

  entity.properties = properties.properties ?? properties;
  return entity;
};
